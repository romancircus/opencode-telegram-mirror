# 2026-02-05 - Cost Crisis Response

## Problem: $150 OpenCode Spending in 2 Days

**Baseline:** Should be ~$10-15/day
**Actual:** $75-85/day
**Root causes identified and fixed.**

---

## Changes Applied

### 1. Disabled Experimental sessionMemory
**File:** `~/.clawdbot/clawdbot.json:49`
```json
"sessionMemory": false  // Was: true
```

**Impact:** Prevents memory search across ALL 280+ previous sessions on every Telegram message.
**Savings:** ~$40-60/day

---

### 2. Reduced Hybrid Search Multiplier
**File:** `~/.clawdbot/clawdbot.json:63`
```json
"candidateMultiplier": 1  // Was: 4
```

**Impact:** 4x fewer API calls per search operation.
**Savings:** ~$10-20/day

---

### 3. Disabled Proton Bridge Health Cron Jobs
**File:** `~/.clawdbot/cron/jobs.json`

Disabled:
- `f487ed1e-a248-45c6-abd4-cfe4396c5504` (hourly health check)
- `a1b2c3d4-e5f6-7890-abcd-ef1234567890` (daily summary)

**Reasoning:** 28+ consecutive failures since Jan 30. Non-functional.
**Savings:** ~$15-25/day

---

## Expected Outcome

| Metric | Before | After (Target) |
|--------|--------|----------------|
| Daily cost | $75-85 | $5-15 |
| Monthly cost | $2250-2550 | $150-450 |
| **SAVINGS** | - | **$1800-2100/month** |

---

## Verification Plan

**24-hour monitoring:**
1. Check OpenCode usage dashboard at EOD 2026-02-05
2. Compare to previous $75-85/day baseline
3. Target: <$15/day
4. If still high, investigate:
   - `~/.clawdbot/memory/main.sqlite` (99MB - may need pruning)
   - High-frequency wake events
   - Gateway API call logs

---

## Service Status

✅ clawdbot-gateway.service restarted with new config
✅ Config changes applied and persisted
✅ All runaway processes killed before restart

---

## Next Steps

**If costs remain high after 24h:**
1. Add cost guardrails to config:
   ```json
   "costLimits": {
     "dailyMax": 10.00,
     "perSessionMax": 1.00
   }
   ```

2. Audit memory database size:
   ```bash
   sqlite3 ~/.clawdbot/memory/main.sqlite "SELECT COUNT(*) FROM sessions;"
   sqlite3 ~/.clawdbot/memory/main.sqlite "SELECT COUNT(*) FROM messages;"
   ```

3. Consider pruning old sessions (>30 days)

4. Move API keys to .env (security best practice)

---

## Critical Files Changed

- `~/.clawdbot/clawdbot.json` - sessionMemory disabled, multiplier reduced
- `~/.clawdbot/cron/jobs.json` - Proton Bridge jobs disabled
- Service restarted: `clawdbot-gateway.service`

---

**Status:** ✅ COMPLETE - Monitor for 24h to confirm savings
